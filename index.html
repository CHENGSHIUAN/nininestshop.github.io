<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’–å©—â˜…å½ˆå½ˆè‹±é›„â˜…</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        /* é€™è£¡ä¿ç•™ä½ ä¹‹å‰çš„ç²‰è‰²ç³» CSS æ¨£å¼... (ç‚ºäº†ç¯€çœç¯‡å¹…ï¼Œæ¨£å¼èˆ‡ä¹‹å‰ç›¸åŒ) */
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background: #f0f0f0; margin: 0; padding: 20px; }
        .game-header { text-align: center; background: #333; color: white; padding: 15px; border-radius: 8px 8px 0 0; }
        .game-header h1 { margin: 0; font-size: 24px; color: #ff69b4; } /* é€™è£¡å¹«ä½ æ”¹æˆäº†ç²‰ç´…è‰² */
        .filter-section { background: white; padding: 20px; border-radius: 0 0 8px 8px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .search-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .search-item { border: 1px solid #ffc1e3; padding: 10px; border-radius: 8px; text-align: center; background: #fff; }
        .search-item img { width: 60px; height: 60px; object-fit: cover; display: block; margin: 0 auto 5px; border-radius: 4px; background: #eee; }
        .search-item .name { font-size: 12px; font-weight: bold; margin-bottom: 5px; display: block; color: #d63384; }
        .counter { display: flex; justify-content: center; align-items: center; gap: 5px; }
        .counter button { width: 22px; height: 22px; cursor: pointer; border: 1px solid #ffc1e3; background: #fff0f6; border-radius: 4px; color: #d63384; }
        .counter input { width: 25px; text-align: center; border: 1px solid #ddd; border-radius: 4px; font-size: 12px; }
        .search-btn { background: #ffb3d1; color: white; border: none; padding: 12px 40px; border-radius: 50px; cursor: pointer; font-size: 18px; font-weight: bold; display: block; margin: 0 auto; box-shadow: 0 4px 0 #f88fb7; }
        .result-table { width: 100%; border-collapse: collapse; background: white; }
        .result-table thead { background: #ffb3d1; color: white; }
        .result-table th, .result-table td { border: 1px solid #eee; padding: 12px; text-align: center; }
        .card-box { width: 75px; text-align: center; position: relative; display: inline-block; margin-right: 10px; }
        .card-box img { width: 100%; height: 75px; object-fit: cover; border: 1px solid #ccc; border-radius: 4px; }
        .card-count-tag { position: absolute; top: -5px; right: -5px; background: #ff0000; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; line-height: 20px; font-weight: bold; }
    </style>
</head>
<body>

<div id="app">
    <header class="game-header">
        <h1>ğŸ’–å©—â­å½ˆå½ˆè‹±é›„â­</h1>
    </header>

    <div class="filter-section">
        <div class="search-grid">
            <div v-for="name in allAvailableCards" :key="name" class="search-item">
                <img :src="'images/' + name + '.jpg'" onerror="this.src='https://via.placeholder.com/60?text=No+Img'">
                <span class="name">{{ name }}</span>
                <div class="counter">
                    <button @click="changeCount(name, -1)">-</button>
                    <input type="text" :value="searchCounts[name] || 0" readonly>
                    <button @click="changeCount(name, 1)">+</button>
                </div>
            </div>
        </div>
        <button class="search-btn" @click="doSearch">ç«‹å³æŸ¥è©¢</button>
    </div>

    <table class="result-table">
        <thead>
            <tr><th style="width: 150px;">ç·¨è™Ÿ</th><th>çµ„åˆå…§å®¹</th></tr>
        </thead>
        <tbody>
            <tr v-for="item in searchResults" :key="item.id">
                <td style="font-weight: bold;">{{ item.id }}</td>
                <td>
                    <div class="card-box" v-for="(count, cardName) in item.cards" :key="cardName">
                        <img :src="'images/' + cardName + '.jpg'" onerror="this.src='https://via.placeholder.com/75?text=No+Img'">
                        <span v-if="count > 1" class="card-count-tag">{{ count }}</span>
                        <div style="font-size: 10px; color: #777;">{{ cardName }}</div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<script>
    const { createApp } = Vue;
    // é‡è¦ï¼šé€™è£¡è«‹è²¼ä¸Šä½ å‰›æ‰è¤‡è£½çš„ Google CSV ç¶²å€
    const SPREADSHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRe_DkETdOHyEKFRMG-FG5nqpI_jqbhyL7-uVlP7JTgS4FuDM8nplYhTBATLshRrsNY1QWPru8p-lun/pub?output=csv'; 

    createApp({
        data() {
            return {
	allAvailableCards: ['é¾ç‚®', 'æ­¦è£æµ·èº', 'æ„›ç¥ä¹‹å¼“', 'ç¹†æ–¯', 'é£›ç¿¼å¤©ç‹¼', 'ç¿ è¶å¥³ç‹', 'ç™½é¾', 'ç³–è±†äºº', 'æ™¶çŸ³å¼“', 'æ™¶çŸ³ç‚®', 'è¬èƒ½å†°ç®±', 'ç¨è§’ç¸å¼“', 'æ™¶çŸ³æ­¥æ§', 'æ™¶çŸ³ç«ç®­ç­’', 'æ€’ç‰™', 'çµé·¹', 'æ™¶çŸ³æ‰‹é›·', 'æ™¶çŸ³æ‰‹ç‚®', 'èŸ²å·¢æ‰‹ç‚®', 'æ´¾å°ä¹‹æ˜Ÿ', 'é«˜å£“æ°´æ§'],
                searchCounts: {},
                allPackages: [],
                searchResults: []
            }
        },
        methods: {
            changeCount(name, delta) {
                let current = this.searchCounts[name] || 0;
                let next = current + delta;
                this.searchCounts[name] = next < 0 ? 0 : next;
            },
            doSearch() {
                this.searchResults = this.allPackages.filter(pkg => {
                    for (let name in this.searchCounts) {
                        if (this.searchCounts[name] > 0 && (pkg.cards[name] || 0) < this.searchCounts[name]) return false;
                    }
                    return true;
                });
            },
            fetchData() {
                Papa.parse(SPREADSHEET_URL, {
                    download: true,
                    header: true,
                    complete: (results) => {
                        this.allPackages = results.data.map(row => {
                            let cardData = {};
                            if (row.content) {
                                row.content.split('+').forEach(part => {
                                    let [name, count] = part.split('x');
                                    cardData[name.trim()] = parseInt(count) || 1;
                                });
                            }
                            return { id: row.id, cards: cardData };
                        });
                        this.searchResults = this.allPackages;
                    }
                });
            }
        },
        mounted() {
            this.allAvailableCards.forEach(n => this.searchCounts[n] = 0);
            this.fetchData();
        }
    }).mount('#app');
</script>
</body>
</html>